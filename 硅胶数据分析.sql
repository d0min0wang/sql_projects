--硅胶年度出库金额数据

SELECT  
    t1.FName,
    sum(case when YEAR(v1.FDate)='2013' then u1.FConsignAmount else 0 END) AS '2013',
    sum(case when YEAR(v1.FDate)='2014' then u1.FConsignAmount else 0 END) AS '2014',
    sum(case when YEAR(v1.FDate)='2015' then u1.FConsignAmount else 0 END) AS '2015',
    sum(case when YEAR(v1.FDate)='2016' then u1.FConsignAmount else 0 END) AS '2016',
    sum(case when YEAR(v1.FDate)='2017' then u1.FConsignAmount else 0 END) AS '2017',
    sum(case when YEAR(v1.FDate)='2018' then u1.FConsignAmount else 0 END) AS '2018',
    sum(case when YEAR(v1.FDate)='2019' then u1.FConsignAmount else 0 END) AS '2019',
    sum(case when YEAR(v1.FDate)='2020' then u1.FConsignAmount else 0 END) AS '2020',
    sum(case when YEAR(v1.FDate)='2021' then u1.FConsignAmount else 0 END) AS '2021',
    sum(case when YEAR(v1.FDate)='2022' then u1.FConsignAmount else 0 END) AS '2022',
    sum(case when YEAR(v1.FDate)='2023' then u1.FConsignAmount else 0 END) AS '2023'
FROM t_ICItem t1 
LEFT JOIN ICStockBillEntry u1 ON t1.FItemID=u1.FItemID
INNER JOIN ICStockBill v1 ON u1.FInterID=v1.FInterID
WHERE 
--YEAR(t2.FCreateDate) in ('2023') AND MONTH(t2.FCreateDate)='10'
--where year(v1.FDate)IN ('2022') 
--and year(t2.FCreateDate) in ('2022')
--and month(v1.FDate)<='6'
t1.FHelpCode like 'GQ%'
and v1.FTranType=21 And v1.FCheckerID>0
GROUP BY t1.FName WITH ROLLUP

--硅胶月度出库数据
SELECT  
    t1.FName,
    sum(case when YEAR(v1.FDate)='2013' then u1.FConsignAmount else 0 END) AS '2013',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='1' then u1.FConsignAmount else 0 END) AS '2013-01',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='2' then u1.FConsignAmount else 0 END) AS '2013-02',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='3' then u1.FConsignAmount else 0 END) AS '2013-03',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='4' then u1.FConsignAmount else 0 END) AS '2013-04',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='5' then u1.FConsignAmount else 0 END) AS '2013-05',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='6' then u1.FConsignAmount else 0 END) AS '2013-06',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='7' then u1.FConsignAmount else 0 END) AS '2013-07',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='8' then u1.FConsignAmount else 0 END) AS '2013-08',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='9' then u1.FConsignAmount else 0 END) AS '2013-09',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='10' then u1.FConsignAmount else 0 END) AS '2013-10',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='11' then u1.FConsignAmount else 0 END) AS '2013-11',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='12' then u1.FConsignAmount else 0 END) AS '2013-12',
    sum(case when YEAR(v1.FDate)='2014' then u1.FConsignAmount else 0 END) AS '2014',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='1' then u1.FConsignAmount else 0 END) AS '2014-01',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='2' then u1.FConsignAmount else 0 END) AS '2014-02',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='3' then u1.FConsignAmount else 0 END) AS '2014-03',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='4' then u1.FConsignAmount else 0 END) AS '2014-04',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='5' then u1.FConsignAmount else 0 END) AS '2014-05',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='6' then u1.FConsignAmount else 0 END) AS '2014-06',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='7' then u1.FConsignAmount else 0 END) AS '2014-07',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='8' then u1.FConsignAmount else 0 END) AS '2014-08',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='9' then u1.FConsignAmount else 0 END) AS '2014-09',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='10' then u1.FConsignAmount else 0 END) AS '2014-10',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='11' then u1.FConsignAmount else 0 END) AS '2014-11',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='12' then u1.FConsignAmount else 0 END) AS '2014-12',
    sum(case when YEAR(v1.FDate)='2015' then u1.FConsignAmount else 0 END) AS '2015',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='1' then u1.FConsignAmount else 0 END) AS '2015-01',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='2' then u1.FConsignAmount else 0 END) AS '2015-02',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='3' then u1.FConsignAmount else 0 END) AS '2015-03',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='4' then u1.FConsignAmount else 0 END) AS '2015-04',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='5' then u1.FConsignAmount else 0 END) AS '2015-05',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='6' then u1.FConsignAmount else 0 END) AS '2015-06',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='7' then u1.FConsignAmount else 0 END) AS '2015-07',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='8' then u1.FConsignAmount else 0 END) AS '2015-08',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='9' then u1.FConsignAmount else 0 END) AS '2015-09',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='10' then u1.FConsignAmount else 0 END) AS '2015-10',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='11' then u1.FConsignAmount else 0 END) AS '2015-11',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='12' then u1.FConsignAmount else 0 END) AS '2015-12',
    sum(case when YEAR(v1.FDate)='2016' then u1.FConsignAmount else 0 END) AS '2016',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='1' then u1.FConsignAmount else 0 END) AS '2016-01',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='2' then u1.FConsignAmount else 0 END) AS '2016-02',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='3' then u1.FConsignAmount else 0 END) AS '2016-03',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='4' then u1.FConsignAmount else 0 END) AS '2016-04',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='5' then u1.FConsignAmount else 0 END) AS '2016-05',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='6' then u1.FConsignAmount else 0 END) AS '2016-06',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='7' then u1.FConsignAmount else 0 END) AS '2016-07',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='8' then u1.FConsignAmount else 0 END) AS '2016-08',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='9' then u1.FConsignAmount else 0 END) AS '2016-09',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='10' then u1.FConsignAmount else 0 END) AS '2016-10',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='11' then u1.FConsignAmount else 0 END) AS '2016-11',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='12' then u1.FConsignAmount else 0 END) AS '2016-12',
    sum(case when YEAR(v1.FDate)='2017' then u1.FConsignAmount else 0 END) AS '2017',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='1' then u1.FConsignAmount else 0 END) AS '2017-01',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='2' then u1.FConsignAmount else 0 END) AS '2017-02',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='3' then u1.FConsignAmount else 0 END) AS '2017-03',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='4' then u1.FConsignAmount else 0 END) AS '2017-04',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='5' then u1.FConsignAmount else 0 END) AS '2017-05',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='6' then u1.FConsignAmount else 0 END) AS '2017-06',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='7' then u1.FConsignAmount else 0 END) AS '2017-07',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='8' then u1.FConsignAmount else 0 END) AS '2017-08',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='9' then u1.FConsignAmount else 0 END) AS '2017-09',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='10' then u1.FConsignAmount else 0 END) AS '2017-10',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='11' then u1.FConsignAmount else 0 END) AS '2017-11',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='12' then u1.FConsignAmount else 0 END) AS '2017-12',
    sum(case when YEAR(v1.FDate)='2018' then u1.FConsignAmount else 0 END) AS '2018',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='1' then u1.FConsignAmount else 0 END) AS '2018-01',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='2' then u1.FConsignAmount else 0 END) AS '2018-02',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='3' then u1.FConsignAmount else 0 END) AS '2018-03',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='4' then u1.FConsignAmount else 0 END) AS '2018-04',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='5' then u1.FConsignAmount else 0 END) AS '2018-05',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='6' then u1.FConsignAmount else 0 END) AS '2018-06',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='7' then u1.FConsignAmount else 0 END) AS '2018-07',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='8' then u1.FConsignAmount else 0 END) AS '2018-08',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='9' then u1.FConsignAmount else 0 END) AS '2018-09',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='10' then u1.FConsignAmount else 0 END) AS '2018-10',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='11' then u1.FConsignAmount else 0 END) AS '2018-11',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='12' then u1.FConsignAmount else 0 END) AS '2018-12',
    sum(case when YEAR(v1.FDate)='2019' then u1.FConsignAmount else 0 END) AS '2019',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='1' then u1.FConsignAmount else 0 END) AS '2019-01',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='2' then u1.FConsignAmount else 0 END) AS '2019-02',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='3' then u1.FConsignAmount else 0 END) AS '2019-03',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='4' then u1.FConsignAmount else 0 END) AS '2019-04',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='5' then u1.FConsignAmount else 0 END) AS '2019-05',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='6' then u1.FConsignAmount else 0 END) AS '2019-06',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='7' then u1.FConsignAmount else 0 END) AS '2019-07',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='8' then u1.FConsignAmount else 0 END) AS '2019-08',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='9' then u1.FConsignAmount else 0 END) AS '2019-09',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='10' then u1.FConsignAmount else 0 END) AS '2019-10',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='11' then u1.FConsignAmount else 0 END) AS '2019-11',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='12' then u1.FConsignAmount else 0 END) AS '2019-12',
    sum(case when YEAR(v1.FDate)='2020' then u1.FConsignAmount else 0 END) AS '2020',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='1' then u1.FConsignAmount else 0 END) AS '2020-01',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='2' then u1.FConsignAmount else 0 END) AS '2020-02',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='3' then u1.FConsignAmount else 0 END) AS '2020-03',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='4' then u1.FConsignAmount else 0 END) AS '2020-04',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='5' then u1.FConsignAmount else 0 END) AS '2020-05',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='6' then u1.FConsignAmount else 0 END) AS '2020-06',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='7' then u1.FConsignAmount else 0 END) AS '2020-07',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='8' then u1.FConsignAmount else 0 END) AS '2020-08',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='9' then u1.FConsignAmount else 0 END) AS '2020-09',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='10' then u1.FConsignAmount else 0 END) AS '2020-10',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='11' then u1.FConsignAmount else 0 END) AS '2020-11',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='12' then u1.FConsignAmount else 0 END) AS '2020-12',
    sum(case when YEAR(v1.FDate)='2021' then u1.FConsignAmount else 0 END) AS '2021',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='1' then u1.FConsignAmount else 0 END) AS '2021-01',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='2' then u1.FConsignAmount else 0 END) AS '2021-02',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='3' then u1.FConsignAmount else 0 END) AS '2021-03',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='4' then u1.FConsignAmount else 0 END) AS '2021-04',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='5' then u1.FConsignAmount else 0 END) AS '2021-05',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='6' then u1.FConsignAmount else 0 END) AS '2021-06',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='7' then u1.FConsignAmount else 0 END) AS '2021-07',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='8' then u1.FConsignAmount else 0 END) AS '2021-08',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='9' then u1.FConsignAmount else 0 END) AS '2021-09',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='10' then u1.FConsignAmount else 0 END) AS '2021-10',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='11' then u1.FConsignAmount else 0 END) AS '2021-11',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='12' then u1.FConsignAmount else 0 END) AS '2021-12',
    sum(case when YEAR(v1.FDate)='2022' then u1.FConsignAmount else 0 END) AS '2022',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='1' then u1.FConsignAmount else 0 END) AS '2022-01',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='2' then u1.FConsignAmount else 0 END) AS '2022-02',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='3' then u1.FConsignAmount else 0 END) AS '2022-03',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='4' then u1.FConsignAmount else 0 END) AS '2022-04',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='5' then u1.FConsignAmount else 0 END) AS '2022-05',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='6' then u1.FConsignAmount else 0 END) AS '2022-06',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='7' then u1.FConsignAmount else 0 END) AS '2022-07',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='8' then u1.FConsignAmount else 0 END) AS '2022-08',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='9' then u1.FConsignAmount else 0 END) AS '2022-09',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='10' then u1.FConsignAmount else 0 END) AS '2022-10',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='11' then u1.FConsignAmount else 0 END) AS '2022-11',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='12' then u1.FConsignAmount else 0 END) AS '2022-12',
    sum(case when YEAR(v1.FDate)='2023' then u1.FConsignAmount else 0 END) AS '2023',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='1' then u1.FConsignAmount else 0 END) AS '2023-01',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='2' then u1.FConsignAmount else 0 END) AS '2023-02',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='3' then u1.FConsignAmount else 0 END) AS '2023-03',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='4' then u1.FConsignAmount else 0 END) AS '2023-04',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='5' then u1.FConsignAmount else 0 END) AS '2023-05',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='6' then u1.FConsignAmount else 0 END) AS '2023-06',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='7' then u1.FConsignAmount else 0 END) AS '2023-07',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='8' then u1.FConsignAmount else 0 END) AS '2023-08',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='9' then u1.FConsignAmount else 0 END) AS '2023-09',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='10' then u1.FConsignAmount else 0 END) AS '2023-10',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='11' then u1.FConsignAmount else 0 END) AS '2023-11',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='12' then u1.FConsignAmount else 0 END) AS '2023-12'
FROM t_ICItem t1 
LEFT JOIN ICStockBillEntry u1 ON t1.FItemID=u1.FItemID
INNER JOIN ICStockBill v1 ON u1.FInterID=v1.FInterID
WHERE 
--YEAR(t2.FCreateDate) in ('2023') AND MONTH(t2.FCreateDate)='10'
--where year(v1.FDate)IN ('2022') 
--and year(t2.FCreateDate) in ('2022')
--and month(v1.FDate)<='6'
t1.FHelpCode like 'GQ%'
and v1.FTranType=21 And v1.FCheckerID>0
GROUP BY t1.FName WITH ROLLUP

--硅胶年度出库数据

SELECT  
    t1.FName,
    sum(case when YEAR(v1.FDate)='2013' then u1.FAuxQty else 0 END) AS '2013',
    sum(case when YEAR(v1.FDate)='2014' then u1.FAuxQty else 0 END) AS '2014',
    sum(case when YEAR(v1.FDate)='2015' then u1.FAuxQty else 0 END) AS '2015',
    sum(case when YEAR(v1.FDate)='2016' then u1.FAuxQty else 0 END) AS '2016',
    sum(case when YEAR(v1.FDate)='2017' then u1.FAuxQty else 0 END) AS '2017',
    sum(case when YEAR(v1.FDate)='2018' then u1.FAuxQty else 0 END) AS '2018',
    sum(case when YEAR(v1.FDate)='2019' then u1.FAuxQty else 0 END) AS '2019',
    sum(case when YEAR(v1.FDate)='2020' then u1.FAuxQty else 0 END) AS '2020',
    sum(case when YEAR(v1.FDate)='2021' then u1.FAuxQty else 0 END) AS '2021',
    sum(case when YEAR(v1.FDate)='2022' then u1.FAuxQty else 0 END) AS '2022',
    sum(case when YEAR(v1.FDate)='2023' then u1.FAuxQty else 0 END) AS '2023'
FROM t_ICItem t1 
LEFT JOIN ICStockBillEntry u1 ON t1.FItemID=u1.FItemID
INNER JOIN ICStockBill v1 ON u1.FInterID=v1.FInterID
WHERE 
--YEAR(t2.FCreateDate) in ('2023') AND MONTH(t2.FCreateDate)='10'
--where year(v1.FDate)IN ('2022') 
--and year(t2.FCreateDate) in ('2022')
--and month(v1.FDate)<='6'
t1.FHelpCode like 'GQ%'
and v1.FTranType=21 And v1.FCheckerID>0
GROUP BY t1.FName WITH ROLLUP

--硅胶月度出库数据
SELECT  
    t1.FName,
    sum(case when YEAR(v1.FDate)='2013' then u1.FAuxQty else 0 END) AS '2013',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2013-01',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2013-02',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2013-03',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2013-04',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2013-05',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2013-06',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2013-07',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2013-08',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2013-09',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2013-10',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2013-11',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2013-12',
    sum(case when YEAR(v1.FDate)='2014' then u1.FAuxQty else 0 END) AS '2014',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2014-01',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2014-02',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2014-03',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2014-04',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2014-05',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2014-06',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2014-07',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2014-08',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2014-09',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2014-10',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2014-11',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2014-12',
    sum(case when YEAR(v1.FDate)='2015' then u1.FAuxQty else 0 END) AS '2015',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2015-01',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2015-02',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2015-03',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2015-04',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2015-05',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2015-06',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2015-07',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2015-08',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2015-09',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2015-10',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2015-11',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2015-12',
    sum(case when YEAR(v1.FDate)='2016' then u1.FAuxQty else 0 END) AS '2016',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2016-01',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2016-02',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2016-03',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2016-04',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2016-05',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2016-06',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2016-07',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2016-08',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2016-09',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2016-10',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2016-11',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2016-12',
    sum(case when YEAR(v1.FDate)='2017' then u1.FAuxQty else 0 END) AS '2017',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2017-01',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2017-02',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2017-03',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2017-04',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2017-05',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2017-06',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2017-07',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2017-08',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2017-09',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2017-10',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2017-11',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2017-12',
    sum(case when YEAR(v1.FDate)='2018' then u1.FAuxQty else 0 END) AS '2018',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2018-01',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2018-02',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2018-03',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2018-04',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2018-05',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2018-06',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2018-07',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2018-08',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2018-09',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2018-10',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2018-11',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2018-12',
    sum(case when YEAR(v1.FDate)='2019' then u1.FAuxQty else 0 END) AS '2019',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2019-01',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2019-02',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2019-03',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2019-04',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2019-05',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2019-06',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2019-07',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2019-08',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2019-09',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2019-10',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2019-11',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2019-12',
    sum(case when YEAR(v1.FDate)='2020' then u1.FAuxQty else 0 END) AS '2020',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2020-01',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2020-02',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2020-03',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2020-04',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2020-05',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2020-06',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2020-07',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2020-08',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2020-09',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2020-10',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2020-11',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2020-12',
    sum(case when YEAR(v1.FDate)='2021' then u1.FAuxQty else 0 END) AS '2021',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2021-01',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2021-02',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2021-03',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2021-04',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2021-05',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2021-06',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2021-07',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2021-08',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2021-09',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2021-10',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2021-11',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2021-12',
    sum(case when YEAR(v1.FDate)='2022' then u1.FAuxQty else 0 END) AS '2022',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2022-01',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2022-02',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2022-03',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2022-04',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2022-05',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2022-06',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2022-07',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2022-08',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2022-09',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2022-10',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2022-11',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2022-12',
    sum(case when YEAR(v1.FDate)='2023' then u1.FAuxQty else 0 END) AS '2023',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2023-01',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2023-02',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2023-03',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2023-04',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2023-05',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2023-06',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2023-07',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2023-08',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2023-09',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2023-10',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2023-11',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2023-12'
FROM t_ICItem t1 
LEFT JOIN ICStockBillEntry u1 ON t1.FItemID=u1.FItemID
INNER JOIN ICStockBill v1 ON u1.FInterID=v1.FInterID
WHERE 
--YEAR(t2.FCreateDate) in ('2023') AND MONTH(t2.FCreateDate)='10'
--where year(v1.FDate)IN ('2022') 
--and year(t2.FCreateDate) in ('2022')
--and month(v1.FDate)<='6'
t1.FHelpCode like 'GQ%'
and v1.FTranType=21 And v1.FCheckerID>0
GROUP BY t1.FName WITH ROLLUP


--硅胶年度订单金额数据

SELECT  
    t1.FName,
    sum(case when YEAR(v1.FDate)='2013' then u1.FEntrySelfS0156 else 0 END) AS '2013',
    sum(case when YEAR(v1.FDate)='2014' then u1.FEntrySelfS0156 else 0 END) AS '2014',
    sum(case when YEAR(v1.FDate)='2015' then u1.FEntrySelfS0156 else 0 END) AS '2015',
    sum(case when YEAR(v1.FDate)='2016' then u1.FEntrySelfS0156 else 0 END) AS '2016',
    sum(case when YEAR(v1.FDate)='2017' then u1.FEntrySelfS0156 else 0 END) AS '2017',
    sum(case when YEAR(v1.FDate)='2018' then u1.FEntrySelfS0156 else 0 END) AS '2018',
    sum(case when YEAR(v1.FDate)='2019' then u1.FEntrySelfS0156 else 0 END) AS '2019',
    sum(case when YEAR(v1.FDate)='2020' then u1.FEntrySelfS0156 else 0 END) AS '2020',
    sum(case when YEAR(v1.FDate)='2021' then u1.FEntrySelfS0156 else 0 END) AS '2021',
    sum(case when YEAR(v1.FDate)='2022' then u1.FEntrySelfS0156 else 0 END) AS '2022',
    sum(case when YEAR(v1.FDate)='2023' then u1.FEntrySelfS0156 else 0 END) AS '2023'
FROM t_ICItem t1 
LEFT JOIN SEOrderentry u1 ON t1.FItemID=u1.FItemID
INNER JOIN SEOrder v1 ON u1.FInterID=v1.FInterID
WHERE 
--YEAR(t2.FCreateDate) in ('2023') AND MONTH(t2.FCreateDate)='10'
--where year(v1.FDate)IN ('2022') 
--and year(t2.FCreateDate) in ('2022')
--and month(v1.FDate)<='6'
t1.FHelpCode like 'GQ%'
AND (v1.FChangeMark=0 AND ( Isnull(v1.FClassTypeID,0)<>1007100) AND ((v1.FCheckerID>0)  AND  v1.FCancellation = 0))
--and v1.FTranType=21 
GROUP BY t1.FName WITH ROLLUP


--硅胶月度订单含税金额数据
SELECT  
    t1.FName,
    sum(case when YEAR(v1.FDate)='2013' then u1.FEntrySelfS0156 else 0 END) AS '2013',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='1' then u1.FEntrySelfS0156 else 0 END) AS '2013-01',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='2' then u1.FEntrySelfS0156 else 0 END) AS '2013-02',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='3' then u1.FEntrySelfS0156 else 0 END) AS '2013-03',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='4' then u1.FEntrySelfS0156 else 0 END) AS '2013-04',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='5' then u1.FEntrySelfS0156 else 0 END) AS '2013-05',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='6' then u1.FEntrySelfS0156 else 0 END) AS '2013-06',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='7' then u1.FEntrySelfS0156 else 0 END) AS '2013-07',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='8' then u1.FEntrySelfS0156 else 0 END) AS '2013-08',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='9' then u1.FEntrySelfS0156 else 0 END) AS '2013-09',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='10' then u1.FEntrySelfS0156 else 0 END) AS '2013-10',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='11' then u1.FEntrySelfS0156 else 0 END) AS '2013-11',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='12' then u1.FEntrySelfS0156 else 0 END) AS '2013-12',
    sum(case when YEAR(v1.FDate)='2014' then u1.FEntrySelfS0156 else 0 END) AS '2014',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='1' then u1.FEntrySelfS0156 else 0 END) AS '2014-01',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='2' then u1.FEntrySelfS0156 else 0 END) AS '2014-02',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='3' then u1.FEntrySelfS0156 else 0 END) AS '2014-03',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='4' then u1.FEntrySelfS0156 else 0 END) AS '2014-04',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='5' then u1.FEntrySelfS0156 else 0 END) AS '2014-05',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='6' then u1.FEntrySelfS0156 else 0 END) AS '2014-06',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='7' then u1.FEntrySelfS0156 else 0 END) AS '2014-07',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='8' then u1.FEntrySelfS0156 else 0 END) AS '2014-08',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='9' then u1.FEntrySelfS0156 else 0 END) AS '2014-09',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='10' then u1.FEntrySelfS0156 else 0 END) AS '2014-10',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='11' then u1.FEntrySelfS0156 else 0 END) AS '2014-11',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='12' then u1.FEntrySelfS0156 else 0 END) AS '2014-12',
    sum(case when YEAR(v1.FDate)='2015' then u1.FEntrySelfS0156 else 0 END) AS '2015',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='1' then u1.FEntrySelfS0156 else 0 END) AS '2015-01',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='2' then u1.FEntrySelfS0156 else 0 END) AS '2015-02',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='3' then u1.FEntrySelfS0156 else 0 END) AS '2015-03',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='4' then u1.FEntrySelfS0156 else 0 END) AS '2015-04',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='5' then u1.FEntrySelfS0156 else 0 END) AS '2015-05',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='6' then u1.FEntrySelfS0156 else 0 END) AS '2015-06',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='7' then u1.FEntrySelfS0156 else 0 END) AS '2015-07',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='8' then u1.FEntrySelfS0156 else 0 END) AS '2015-08',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='9' then u1.FEntrySelfS0156 else 0 END) AS '2015-09',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='10' then u1.FEntrySelfS0156 else 0 END) AS '2015-10',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='11' then u1.FEntrySelfS0156 else 0 END) AS '2015-11',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='12' then u1.FEntrySelfS0156 else 0 END) AS '2015-12',
    sum(case when YEAR(v1.FDate)='2016' then u1.FEntrySelfS0156 else 0 END) AS '2016',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='1' then u1.FEntrySelfS0156 else 0 END) AS '2016-01',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='2' then u1.FEntrySelfS0156 else 0 END) AS '2016-02',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='3' then u1.FEntrySelfS0156 else 0 END) AS '2016-03',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='4' then u1.FEntrySelfS0156 else 0 END) AS '2016-04',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='5' then u1.FEntrySelfS0156 else 0 END) AS '2016-05',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='6' then u1.FEntrySelfS0156 else 0 END) AS '2016-06',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='7' then u1.FEntrySelfS0156 else 0 END) AS '2016-07',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='8' then u1.FEntrySelfS0156 else 0 END) AS '2016-08',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='9' then u1.FEntrySelfS0156 else 0 END) AS '2016-09',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='10' then u1.FEntrySelfS0156 else 0 END) AS '2016-10',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='11' then u1.FEntrySelfS0156 else 0 END) AS '2016-11',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='12' then u1.FEntrySelfS0156 else 0 END) AS '2016-12',
    sum(case when YEAR(v1.FDate)='2017' then u1.FEntrySelfS0156 else 0 END) AS '2017',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='1' then u1.FEntrySelfS0156 else 0 END) AS '2017-01',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='2' then u1.FEntrySelfS0156 else 0 END) AS '2017-02',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='3' then u1.FEntrySelfS0156 else 0 END) AS '2017-03',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='4' then u1.FEntrySelfS0156 else 0 END) AS '2017-04',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='5' then u1.FEntrySelfS0156 else 0 END) AS '2017-05',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='6' then u1.FEntrySelfS0156 else 0 END) AS '2017-06',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='7' then u1.FEntrySelfS0156 else 0 END) AS '2017-07',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='8' then u1.FEntrySelfS0156 else 0 END) AS '2017-08',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='9' then u1.FEntrySelfS0156 else 0 END) AS '2017-09',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='10' then u1.FEntrySelfS0156 else 0 END) AS '2017-10',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='11' then u1.FEntrySelfS0156 else 0 END) AS '2017-11',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='12' then u1.FEntrySelfS0156 else 0 END) AS '2017-12',
    sum(case when YEAR(v1.FDate)='2018' then u1.FEntrySelfS0156 else 0 END) AS '2018',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='1' then u1.FEntrySelfS0156 else 0 END) AS '2018-01',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='2' then u1.FEntrySelfS0156 else 0 END) AS '2018-02',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='3' then u1.FEntrySelfS0156 else 0 END) AS '2018-03',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='4' then u1.FEntrySelfS0156 else 0 END) AS '2018-04',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='5' then u1.FEntrySelfS0156 else 0 END) AS '2018-05',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='6' then u1.FEntrySelfS0156 else 0 END) AS '2018-06',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='7' then u1.FEntrySelfS0156 else 0 END) AS '2018-07',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='8' then u1.FEntrySelfS0156 else 0 END) AS '2018-08',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='9' then u1.FEntrySelfS0156 else 0 END) AS '2018-09',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='10' then u1.FEntrySelfS0156 else 0 END) AS '2018-10',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='11' then u1.FEntrySelfS0156 else 0 END) AS '2018-11',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='12' then u1.FEntrySelfS0156 else 0 END) AS '2018-12',
    sum(case when YEAR(v1.FDate)='2019' then u1.FEntrySelfS0156 else 0 END) AS '2019',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='1' then u1.FEntrySelfS0156 else 0 END) AS '2019-01',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='2' then u1.FEntrySelfS0156 else 0 END) AS '2019-02',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='3' then u1.FEntrySelfS0156 else 0 END) AS '2019-03',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='4' then u1.FEntrySelfS0156 else 0 END) AS '2019-04',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='5' then u1.FEntrySelfS0156 else 0 END) AS '2019-05',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='6' then u1.FEntrySelfS0156 else 0 END) AS '2019-06',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='7' then u1.FEntrySelfS0156 else 0 END) AS '2019-07',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='8' then u1.FEntrySelfS0156 else 0 END) AS '2019-08',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='9' then u1.FEntrySelfS0156 else 0 END) AS '2019-09',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='10' then u1.FEntrySelfS0156 else 0 END) AS '2019-10',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='11' then u1.FEntrySelfS0156 else 0 END) AS '2019-11',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='12' then u1.FEntrySelfS0156 else 0 END) AS '2019-12',
    sum(case when YEAR(v1.FDate)='2020' then u1.FEntrySelfS0156 else 0 END) AS '2020',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='1' then u1.FEntrySelfS0156 else 0 END) AS '2020-01',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='2' then u1.FEntrySelfS0156 else 0 END) AS '2020-02',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='3' then u1.FEntrySelfS0156 else 0 END) AS '2020-03',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='4' then u1.FEntrySelfS0156 else 0 END) AS '2020-04',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='5' then u1.FEntrySelfS0156 else 0 END) AS '2020-05',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='6' then u1.FEntrySelfS0156 else 0 END) AS '2020-06',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='7' then u1.FEntrySelfS0156 else 0 END) AS '2020-07',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='8' then u1.FEntrySelfS0156 else 0 END) AS '2020-08',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='9' then u1.FEntrySelfS0156 else 0 END) AS '2020-09',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='10' then u1.FEntrySelfS0156 else 0 END) AS '2020-10',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='11' then u1.FEntrySelfS0156 else 0 END) AS '2020-11',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='12' then u1.FEntrySelfS0156 else 0 END) AS '2020-12',
    sum(case when YEAR(v1.FDate)='2021' then u1.FEntrySelfS0156 else 0 END) AS '2021',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='1' then u1.FEntrySelfS0156 else 0 END) AS '2021-01',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='2' then u1.FEntrySelfS0156 else 0 END) AS '2021-02',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='3' then u1.FEntrySelfS0156 else 0 END) AS '2021-03',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='4' then u1.FEntrySelfS0156 else 0 END) AS '2021-04',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='5' then u1.FEntrySelfS0156 else 0 END) AS '2021-05',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='6' then u1.FEntrySelfS0156 else 0 END) AS '2021-06',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='7' then u1.FEntrySelfS0156 else 0 END) AS '2021-07',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='8' then u1.FEntrySelfS0156 else 0 END) AS '2021-08',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='9' then u1.FEntrySelfS0156 else 0 END) AS '2021-09',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='10' then u1.FEntrySelfS0156 else 0 END) AS '2021-10',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='11' then u1.FEntrySelfS0156 else 0 END) AS '2021-11',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='12' then u1.FEntrySelfS0156 else 0 END) AS '2021-12',
    sum(case when YEAR(v1.FDate)='2022' then u1.FEntrySelfS0156 else 0 END) AS '2022',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='1' then u1.FEntrySelfS0156 else 0 END) AS '2022-01',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='2' then u1.FEntrySelfS0156 else 0 END) AS '2022-02',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='3' then u1.FEntrySelfS0156 else 0 END) AS '2022-03',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='4' then u1.FEntrySelfS0156 else 0 END) AS '2022-04',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='5' then u1.FEntrySelfS0156 else 0 END) AS '2022-05',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='6' then u1.FEntrySelfS0156 else 0 END) AS '2022-06',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='7' then u1.FEntrySelfS0156 else 0 END) AS '2022-07',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='8' then u1.FEntrySelfS0156 else 0 END) AS '2022-08',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='9' then u1.FEntrySelfS0156 else 0 END) AS '2022-09',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='10' then u1.FEntrySelfS0156 else 0 END) AS '2022-10',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='11' then u1.FEntrySelfS0156 else 0 END) AS '2022-11',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='12' then u1.FEntrySelfS0156 else 0 END) AS '2022-12',
    sum(case when YEAR(v1.FDate)='2023' then u1.FEntrySelfS0156 else 0 END) AS '2023',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='1' then u1.FEntrySelfS0156 else 0 END) AS '2023-01',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='2' then u1.FEntrySelfS0156 else 0 END) AS '2023-02',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='3' then u1.FEntrySelfS0156 else 0 END) AS '2023-03',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='4' then u1.FEntrySelfS0156 else 0 END) AS '2023-04',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='5' then u1.FEntrySelfS0156 else 0 END) AS '2023-05',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='6' then u1.FEntrySelfS0156 else 0 END) AS '2023-06',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='7' then u1.FEntrySelfS0156 else 0 END) AS '2023-07',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='8' then u1.FEntrySelfS0156 else 0 END) AS '2023-08',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='9' then u1.FEntrySelfS0156 else 0 END) AS '2023-09',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='10' then u1.FEntrySelfS0156 else 0 END) AS '2023-10',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='11' then u1.FEntrySelfS0156 else 0 END) AS '2023-11',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='12' then u1.FEntrySelfS0156 else 0 END) AS '2023-12'
FROM t_ICItem t1 
LEFT JOIN seorderentry u1 ON t1.FItemID=u1.FItemID
INNER JOIN SEOrder v1 ON u1.FInterID=v1.FInterID
WHERE 
--YEAR(t2.FCreateDate) in ('2023') AND MONTH(t2.FCreateDate)='10'
--where year(v1.FDate)IN ('2022') 
--and year(t2.FCreateDate) in ('2022')
--and month(v1.FDate)<='6'
t1.FHelpCode like 'GQ%'
AND (v1.FChangeMark=0 AND ( Isnull(v1.FClassTypeID,0)<>1007100) AND ((v1.FCheckerID>0)  AND  v1.FCancellation = 0))
GROUP BY t1.FName WITH ROLLUP

--硅胶年度订单数据

SELECT  
    t1.FName,
    sum(case when YEAR(v1.FDate)='2013' then u1.FAuxQty else 0 END) AS '2013',
    sum(case when YEAR(v1.FDate)='2014' then u1.FAuxQty else 0 END) AS '2014',
    sum(case when YEAR(v1.FDate)='2015' then u1.FAuxQty else 0 END) AS '2015',
    sum(case when YEAR(v1.FDate)='2016' then u1.FAuxQty else 0 END) AS '2016',
    sum(case when YEAR(v1.FDate)='2017' then u1.FAuxQty else 0 END) AS '2017',
    sum(case when YEAR(v1.FDate)='2018' then u1.FAuxQty else 0 END) AS '2018',
    sum(case when YEAR(v1.FDate)='2019' then u1.FAuxQty else 0 END) AS '2019',
    sum(case when YEAR(v1.FDate)='2020' then u1.FAuxQty else 0 END) AS '2020',
    sum(case when YEAR(v1.FDate)='2021' then u1.FAuxQty else 0 END) AS '2021',
    sum(case when YEAR(v1.FDate)='2022' then u1.FAuxQty else 0 END) AS '2022',
    sum(case when YEAR(v1.FDate)='2023' then u1.FAuxQty else 0 END) AS '2023'
FROM t_ICItem t1 
LEFT JOIN SEOrderentry u1 ON t1.FItemID=u1.FItemID
INNER JOIN SEOrder v1 ON u1.FInterID=v1.FInterID
WHERE 
--YEAR(t2.FCreateDate) in ('2023') AND MONTH(t2.FCreateDate)='10'
--where year(v1.FDate)IN ('2022') 
--and year(t2.FCreateDate) in ('2022')
--and month(v1.FDate)<='6'
t1.FHelpCode like 'GQ%'
AND (v1.FChangeMark=0 AND ( Isnull(v1.FClassTypeID,0)<>1007100) AND ((v1.FCheckerID>0)  AND  v1.FCancellation = 0))
--and v1.FTranType=21 
GROUP BY t1.FName WITH ROLLUP


--硅胶月度订单数据
SELECT  
    t1.FName,
    sum(case when YEAR(v1.FDate)='2013' then u1.FAuxQty else 0 END) AS '2013',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2013-01',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2013-02',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2013-03',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2013-04',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2013-05',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2013-06',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2013-07',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2013-08',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2013-09',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2013-10',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2013-11',
    sum(case when YEAR(v1.FDate)='2013' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2013-12',
    sum(case when YEAR(v1.FDate)='2014' then u1.FAuxQty else 0 END) AS '2014',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2014-01',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2014-02',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2014-03',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2014-04',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2014-05',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2014-06',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2014-07',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2014-08',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2014-09',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2014-10',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2014-11',
    sum(case when YEAR(v1.FDate)='2014' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2014-12',
    sum(case when YEAR(v1.FDate)='2015' then u1.FAuxQty else 0 END) AS '2015',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2015-01',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2015-02',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2015-03',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2015-04',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2015-05',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2015-06',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2015-07',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2015-08',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2015-09',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2015-10',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2015-11',
    sum(case when YEAR(v1.FDate)='2015' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2015-12',
    sum(case when YEAR(v1.FDate)='2016' then u1.FAuxQty else 0 END) AS '2016',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2016-01',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2016-02',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2016-03',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2016-04',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2016-05',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2016-06',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2016-07',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2016-08',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2016-09',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2016-10',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2016-11',
    sum(case when YEAR(v1.FDate)='2016' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2016-12',
    sum(case when YEAR(v1.FDate)='2017' then u1.FAuxQty else 0 END) AS '2017',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2017-01',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2017-02',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2017-03',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2017-04',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2017-05',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2017-06',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2017-07',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2017-08',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2017-09',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2017-10',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2017-11',
    sum(case when YEAR(v1.FDate)='2017' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2017-12',
    sum(case when YEAR(v1.FDate)='2018' then u1.FAuxQty else 0 END) AS '2018',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2018-01',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2018-02',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2018-03',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2018-04',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2018-05',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2018-06',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2018-07',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2018-08',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2018-09',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2018-10',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2018-11',
    sum(case when YEAR(v1.FDate)='2018' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2018-12',
    sum(case when YEAR(v1.FDate)='2019' then u1.FAuxQty else 0 END) AS '2019',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2019-01',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2019-02',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2019-03',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2019-04',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2019-05',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2019-06',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2019-07',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2019-08',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2019-09',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2019-10',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2019-11',
    sum(case when YEAR(v1.FDate)='2019' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2019-12',
    sum(case when YEAR(v1.FDate)='2020' then u1.FAuxQty else 0 END) AS '2020',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2020-01',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2020-02',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2020-03',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2020-04',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2020-05',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2020-06',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2020-07',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2020-08',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2020-09',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2020-10',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2020-11',
    sum(case when YEAR(v1.FDate)='2020' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2020-12',
    sum(case when YEAR(v1.FDate)='2021' then u1.FAuxQty else 0 END) AS '2021',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2021-01',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2021-02',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2021-03',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2021-04',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2021-05',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2021-06',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2021-07',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2021-08',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2021-09',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2021-10',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2021-11',
    sum(case when YEAR(v1.FDate)='2021' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2021-12',
    sum(case when YEAR(v1.FDate)='2022' then u1.FAuxQty else 0 END) AS '2022',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2022-01',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2022-02',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2022-03',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2022-04',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2022-05',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2022-06',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2022-07',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2022-08',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2022-09',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2022-10',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2022-11',
    sum(case when YEAR(v1.FDate)='2022' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2022-12',
    sum(case when YEAR(v1.FDate)='2023' then u1.FAuxQty else 0 END) AS '2023',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='1' then u1.FAuxQty else 0 END) AS '2023-01',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='2' then u1.FAuxQty else 0 END) AS '2023-02',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='3' then u1.FAuxQty else 0 END) AS '2023-03',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='4' then u1.FAuxQty else 0 END) AS '2023-04',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='5' then u1.FAuxQty else 0 END) AS '2023-05',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='6' then u1.FAuxQty else 0 END) AS '2023-06',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='7' then u1.FAuxQty else 0 END) AS '2023-07',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='8' then u1.FAuxQty else 0 END) AS '2023-08',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='9' then u1.FAuxQty else 0 END) AS '2023-09',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='10' then u1.FAuxQty else 0 END) AS '2023-10',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='11' then u1.FAuxQty else 0 END) AS '2023-11',
    sum(case when YEAR(v1.FDate)='2023' and MONTH(v1.FDate)='12' then u1.FAuxQty else 0 END) AS '2023-12'
FROM t_ICItem t1 
LEFT JOIN seorderentry u1 ON t1.FItemID=u1.FItemID
INNER JOIN SEOrder v1 ON u1.FInterID=v1.FInterID
WHERE 
--YEAR(t2.FCreateDate) in ('2023') AND MONTH(t2.FCreateDate)='10'
--where year(v1.FDate)IN ('2022') 
--and year(t2.FCreateDate) in ('2022')
--and month(v1.FDate)<='6'
t1.FHelpCode like 'GQ%'
AND (v1.FChangeMark=0 AND ( Isnull(v1.FClassTypeID,0)<>1007100) AND ((v1.FCheckerID>0)  AND  v1.FCancellation = 0))
GROUP BY t1.FName WITH ROLLUP

--硅胶产品年度制造数量
SELECT j.FName,
       sum(case when YEAR(m.FDate)='2013' then i.FAuxQtyPass else 0 END) AS '2013',
       sum(case when YEAR(m.FDate)='2014' then i.FAuxQtyPass else 0 END) AS '2014',
       sum(case when YEAR(m.FDate)='2015' then i.FAuxQtyPass else 0 END) AS '2015',
       sum(case when YEAR(m.FDate)='2016' then i.FAuxQtyPass else 0 END) AS '2016',
       sum(case when YEAR(m.FDate)='2017' then i.FAuxQtyPass else 0 END) AS '2017',
       sum(case when YEAR(m.FDate)='2018' then i.FAuxQtyPass else 0 END) AS '2018',
       sum(case when YEAR(m.FDate)='2019' then i.FAuxQtyPass else 0 END) AS '2019',
       sum(case when YEAR(m.FDate)='2020' then i.FAuxQtyPass else 0 END) AS '2020',
       sum(case when YEAR(m.FDate)='2021' then i.FAuxQtyPass else 0 END) AS '2021',
       sum(case when YEAR(m.FDate)='2022' then i.FAuxQtyPass else 0 END) AS '2022',
       sum(case when YEAR(m.FDate)='2023' then i.FAuxQtyPass else 0 END) AS '2023'
       --SUM(i.FAuxWhtPass) AS FAuxWhtPass
FROM t_ICItem j
LEFT join SHProcRpt i ON j.FItemID = i.FItemID
LEFT JOIN t_SubMessage l ON i.FOperID = l.FInterID
LEFT JOIN SHProcRptMain m ON i.FInterID = m.FInterID
WHERE l.FName = '成型'
and j.FHelpCode like 'GQ%'
GROUP BY j.FName WITH ROLLUP


--硅胶产品月度制造数量
SELECT j.FName,
       sum(case when YEAR(m.FDate)='2013' then i.FAuxQtyPass else 0 END) AS '2013',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='1' then i.FAuxQtyPass else 0 END) AS '2013-01',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='2' then i.FAuxQtyPass else 0 END) AS '2013-02',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='3' then i.FAuxQtyPass else 0 END) AS '2013-03',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='4' then i.FAuxQtyPass else 0 END) AS '2013-04',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='5' then i.FAuxQtyPass else 0 END) AS '2013-05',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='6' then i.FAuxQtyPass else 0 END) AS '2013-06',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='7' then i.FAuxQtyPass else 0 END) AS '2013-07',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='8' then i.FAuxQtyPass else 0 END) AS '2013-08',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='9' then i.FAuxQtyPass else 0 END) AS '2013-09',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='10' then i.FAuxQtyPass else 0 END) AS '2013-10',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='11' then i.FAuxQtyPass else 0 END) AS '2013-11',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='12' then i.FAuxQtyPass else 0 END) AS '2013-12',
       sum(case when YEAR(m.FDate)='2014' then i.FAuxQtyPass else 0 END) AS '2014',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='1' then i.FAuxQtyPass else 0 END) AS '2014-01',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='2' then i.FAuxQtyPass else 0 END) AS '2014-02',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='3' then i.FAuxQtyPass else 0 END) AS '2014-03',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='4' then i.FAuxQtyPass else 0 END) AS '2014-04',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='5' then i.FAuxQtyPass else 0 END) AS '2014-05',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='6' then i.FAuxQtyPass else 0 END) AS '2014-06',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='7' then i.FAuxQtyPass else 0 END) AS '2014-07',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='8' then i.FAuxQtyPass else 0 END) AS '2014-08',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='9' then i.FAuxQtyPass else 0 END) AS '2014-09',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='10' then i.FAuxQtyPass else 0 END) AS '2014-10',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='11' then i.FAuxQtyPass else 0 END) AS '2014-11',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='12' then i.FAuxQtyPass else 0 END) AS '2014-12',
       sum(case when YEAR(m.FDate)='2015' then i.FAuxQtyPass else 0 END) AS '2015',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='1' then i.FAuxQtyPass else 0 END) AS '2015-01',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='2' then i.FAuxQtyPass else 0 END) AS '2015-02',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='3' then i.FAuxQtyPass else 0 END) AS '2015-03',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='4' then i.FAuxQtyPass else 0 END) AS '2015-04',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='5' then i.FAuxQtyPass else 0 END) AS '2015-05',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='6' then i.FAuxQtyPass else 0 END) AS '2015-06',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='7' then i.FAuxQtyPass else 0 END) AS '2015-07',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='8' then i.FAuxQtyPass else 0 END) AS '2015-08',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='9' then i.FAuxQtyPass else 0 END) AS '2015-09',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='10' then i.FAuxQtyPass else 0 END) AS '2015-10',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='11' then i.FAuxQtyPass else 0 END) AS '2015-11',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='12' then i.FAuxQtyPass else 0 END) AS '2015-12',
       sum(case when YEAR(m.FDate)='2016' then i.FAuxQtyPass else 0 END) AS '2016',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='1' then i.FAuxQtyPass else 0 END) AS '2016-01',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='2' then i.FAuxQtyPass else 0 END) AS '2016-02',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='3' then i.FAuxQtyPass else 0 END) AS '2016-03',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='4' then i.FAuxQtyPass else 0 END) AS '2016-04',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='5' then i.FAuxQtyPass else 0 END) AS '2016-05',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='6' then i.FAuxQtyPass else 0 END) AS '2016-06',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='7' then i.FAuxQtyPass else 0 END) AS '2016-07',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='8' then i.FAuxQtyPass else 0 END) AS '2016-08',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='9' then i.FAuxQtyPass else 0 END) AS '2016-09',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='10' then i.FAuxQtyPass else 0 END) AS '2016-10',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='11' then i.FAuxQtyPass else 0 END) AS '2016-11',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='12' then i.FAuxQtyPass else 0 END) AS '2016-12',
       sum(case when YEAR(m.FDate)='2017' then i.FAuxQtyPass else 0 END) AS '2017',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='1' then i.FAuxQtyPass else 0 END) AS '2017-01',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='2' then i.FAuxQtyPass else 0 END) AS '2017-02',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='3' then i.FAuxQtyPass else 0 END) AS '2017-03',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='4' then i.FAuxQtyPass else 0 END) AS '2017-04',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='5' then i.FAuxQtyPass else 0 END) AS '2017-05',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='6' then i.FAuxQtyPass else 0 END) AS '2017-06',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='7' then i.FAuxQtyPass else 0 END) AS '2017-07',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='8' then i.FAuxQtyPass else 0 END) AS '2017-08',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='9' then i.FAuxQtyPass else 0 END) AS '2017-09',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='10' then i.FAuxQtyPass else 0 END) AS '2017-10',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='11' then i.FAuxQtyPass else 0 END) AS '2017-11',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='12' then i.FAuxQtyPass else 0 END) AS '2017-12',
       sum(case when YEAR(m.FDate)='2018' then i.FAuxQtyPass else 0 END) AS '2018',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='1' then i.FAuxQtyPass else 0 END) AS '2018-01',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='2' then i.FAuxQtyPass else 0 END) AS '2018-02',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='3' then i.FAuxQtyPass else 0 END) AS '2018-03',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='4' then i.FAuxQtyPass else 0 END) AS '2018-04',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='5' then i.FAuxQtyPass else 0 END) AS '2018-05',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='6' then i.FAuxQtyPass else 0 END) AS '2018-06',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='7' then i.FAuxQtyPass else 0 END) AS '2018-07',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='8' then i.FAuxQtyPass else 0 END) AS '2018-08',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='9' then i.FAuxQtyPass else 0 END) AS '2018-09',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='10' then i.FAuxQtyPass else 0 END) AS '2018-10',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='11' then i.FAuxQtyPass else 0 END) AS '2018-11',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='12' then i.FAuxQtyPass else 0 END) AS '2018-12',
       sum(case when YEAR(m.FDate)='2019' then i.FAuxQtyPass else 0 END) AS '2019',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='1' then i.FAuxQtyPass else 0 END) AS '2019-01',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='2' then i.FAuxQtyPass else 0 END) AS '2019-02',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='3' then i.FAuxQtyPass else 0 END) AS '2019-03',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='4' then i.FAuxQtyPass else 0 END) AS '2019-04',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='5' then i.FAuxQtyPass else 0 END) AS '2019-05',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='6' then i.FAuxQtyPass else 0 END) AS '2019-06',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='7' then i.FAuxQtyPass else 0 END) AS '2019-07',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='8' then i.FAuxQtyPass else 0 END) AS '2019-08',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='9' then i.FAuxQtyPass else 0 END) AS '2019-09',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='10' then i.FAuxQtyPass else 0 END) AS '2019-10',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='11' then i.FAuxQtyPass else 0 END) AS '2019-11',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='12' then i.FAuxQtyPass else 0 END) AS '2019-12',
       sum(case when YEAR(m.FDate)='2020' then i.FAuxQtyPass else 0 END) AS '2020',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='1' then i.FAuxQtyPass else 0 END) AS '2020-01',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='2' then i.FAuxQtyPass else 0 END) AS '2020-02',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='3' then i.FAuxQtyPass else 0 END) AS '2020-03',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='4' then i.FAuxQtyPass else 0 END) AS '2020-04',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='5' then i.FAuxQtyPass else 0 END) AS '2020-05',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='6' then i.FAuxQtyPass else 0 END) AS '2020-06',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='7' then i.FAuxQtyPass else 0 END) AS '2020-07',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='8' then i.FAuxQtyPass else 0 END) AS '2020-08',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='9' then i.FAuxQtyPass else 0 END) AS '2020-09',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='10' then i.FAuxQtyPass else 0 END) AS '2020-10',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='11' then i.FAuxQtyPass else 0 END) AS '2020-11',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='12' then i.FAuxQtyPass else 0 END) AS '2020-12',
       sum(case when YEAR(m.FDate)='2021' then i.FAuxQtyPass else 0 END) AS '2021',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='1' then i.FAuxQtyPass else 0 END) AS '2021-01',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='2' then i.FAuxQtyPass else 0 END) AS '2021-02',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='3' then i.FAuxQtyPass else 0 END) AS '2021-03',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='4' then i.FAuxQtyPass else 0 END) AS '2021-04',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='5' then i.FAuxQtyPass else 0 END) AS '2021-05',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='6' then i.FAuxQtyPass else 0 END) AS '2021-06',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='7' then i.FAuxQtyPass else 0 END) AS '2021-07',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='8' then i.FAuxQtyPass else 0 END) AS '2021-08',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='9' then i.FAuxQtyPass else 0 END) AS '2021-09',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='10' then i.FAuxQtyPass else 0 END) AS '2021-10',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='11' then i.FAuxQtyPass else 0 END) AS '2021-11',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='12' then i.FAuxQtyPass else 0 END) AS '2021-12',
       sum(case when YEAR(m.FDate)='2022' then i.FAuxQtyPass else 0 END) AS '2022',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='1' then i.FAuxQtyPass else 0 END) AS '2022-01',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='2' then i.FAuxQtyPass else 0 END) AS '2022-02',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='3' then i.FAuxQtyPass else 0 END) AS '2022-03',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='4' then i.FAuxQtyPass else 0 END) AS '2022-04',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='5' then i.FAuxQtyPass else 0 END) AS '2022-05',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='6' then i.FAuxQtyPass else 0 END) AS '2022-06',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='7' then i.FAuxQtyPass else 0 END) AS '2022-07',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='8' then i.FAuxQtyPass else 0 END) AS '2022-08',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='9' then i.FAuxQtyPass else 0 END) AS '2022-09',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='10' then i.FAuxQtyPass else 0 END) AS '2022-10',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='11' then i.FAuxQtyPass else 0 END) AS '2022-11',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='12' then i.FAuxQtyPass else 0 END) AS '2022-12',
       sum(case when YEAR(m.FDate)='2023' then i.FAuxQtyPass else 0 END) AS '2023',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='1' then i.FAuxQtyPass else 0 END) AS '2023-01',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='2' then i.FAuxQtyPass else 0 END) AS '2023-02',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='3' then i.FAuxQtyPass else 0 END) AS '2023-03',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='4' then i.FAuxQtyPass else 0 END) AS '2023-04',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='5' then i.FAuxQtyPass else 0 END) AS '2023-05',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='6' then i.FAuxQtyPass else 0 END) AS '2023-06',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='7' then i.FAuxQtyPass else 0 END) AS '2023-07',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='8' then i.FAuxQtyPass else 0 END) AS '2023-08',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='9' then i.FAuxQtyPass else 0 END) AS '2023-09',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='10' then i.FAuxQtyPass else 0 END) AS '2023-10',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='11' then i.FAuxQtyPass else 0 END) AS '2023-11',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='12' then i.FAuxQtyPass else 0 END) AS '2023-12'
       --SUM(i.FAuxWhtPass) AS FAuxWhtPass
FROM t_ICItem j
LEFT join SHProcRpt i ON j.FItemID = i.FItemID
LEFT JOIN t_SubMessage l ON i.FOperID = l.FInterID
LEFT JOIN SHProcRptMain m ON i.FInterID = m.FInterID
WHERE l.FName = '成型'
and j.FHelpCode like 'GQ%'
GROUP BY j.FName WITH ROLLUP



--硅胶产品年度制造重量
SELECT j.FHelpCode,
       sum(case when YEAR(m.FDate)='2013' then i.FAuxWhtPass else 0 END) AS '2013',
       sum(case when YEAR(m.FDate)='2014' then i.FAuxWhtPass else 0 END) AS '2014',
       sum(case when YEAR(m.FDate)='2015' then i.FAuxWhtPass else 0 END) AS '2015',
       sum(case when YEAR(m.FDate)='2016' then i.FAuxWhtPass else 0 END) AS '2016',
       sum(case when YEAR(m.FDate)='2017' then i.FAuxWhtPass else 0 END) AS '2017',
       sum(case when YEAR(m.FDate)='2018' then i.FAuxWhtPass else 0 END) AS '2018',
       sum(case when YEAR(m.FDate)='2019' then i.FAuxWhtPass else 0 END) AS '2019',
       sum(case when YEAR(m.FDate)='2020' then i.FAuxWhtPass else 0 END) AS '2020',
       sum(case when YEAR(m.FDate)='2021' then i.FAuxWhtPass else 0 END) AS '2021',
       sum(case when YEAR(m.FDate)='2022' then i.FAuxWhtPass else 0 END) AS '2022',
       sum(case when YEAR(m.FDate)='2023' then i.FAuxWhtPass else 0 END) AS '2023'
       --SUM(i.FAuxWhtPass) AS FAuxWhtPass
FROM t_ICItem j
LEFT join SHProcRpt i ON j.FItemID = i.FItemID
LEFT JOIN t_SubMessage l ON i.FOperID = l.FInterID
LEFT JOIN SHProcRptMain m ON i.FInterID = m.FInterID
WHERE l.FName = '成型'
and j.FHelpCode like 'GQ%'
GROUP BY j.FHelpCode WITH ROLLUP



--硅胶产品月度制造数量
SELECT j.FHelpCode,
       sum(case when YEAR(m.FDate)='2013' then i.FAuxWhtPass else 0 END) AS '2013',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='1' then i.FAuxWhtPass else 0 END) AS '2013-01',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='2' then i.FAuxWhtPass else 0 END) AS '2013-02',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='3' then i.FAuxWhtPass else 0 END) AS '2013-03',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='4' then i.FAuxWhtPass else 0 END) AS '2013-04',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='5' then i.FAuxWhtPass else 0 END) AS '2013-05',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='6' then i.FAuxWhtPass else 0 END) AS '2013-06',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='7' then i.FAuxWhtPass else 0 END) AS '2013-07',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='8' then i.FAuxWhtPass else 0 END) AS '2013-08',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='9' then i.FAuxWhtPass else 0 END) AS '2013-09',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='10' then i.FAuxWhtPass else 0 END) AS '2013-10',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='11' then i.FAuxWhtPass else 0 END) AS '2013-11',
       sum(case when YEAR(m.FDate)='2013' and MONTH(m.FDate)='12' then i.FAuxWhtPass else 0 END) AS '2013-12',
       sum(case when YEAR(m.FDate)='2014' then i.FAuxWhtPass else 0 END) AS '2014',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='1' then i.FAuxWhtPass else 0 END) AS '2014-01',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='2' then i.FAuxWhtPass else 0 END) AS '2014-02',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='3' then i.FAuxWhtPass else 0 END) AS '2014-03',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='4' then i.FAuxWhtPass else 0 END) AS '2014-04',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='5' then i.FAuxWhtPass else 0 END) AS '2014-05',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='6' then i.FAuxWhtPass else 0 END) AS '2014-06',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='7' then i.FAuxWhtPass else 0 END) AS '2014-07',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='8' then i.FAuxWhtPass else 0 END) AS '2014-08',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='9' then i.FAuxWhtPass else 0 END) AS '2014-09',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='10' then i.FAuxWhtPass else 0 END) AS '2014-10',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='11' then i.FAuxWhtPass else 0 END) AS '2014-11',
       sum(case when YEAR(m.FDate)='2014' and MONTH(m.FDate)='12' then i.FAuxWhtPass else 0 END) AS '2014-12',
       sum(case when YEAR(m.FDate)='2015' then i.FAuxWhtPass else 0 END) AS '2015',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='1' then i.FAuxWhtPass else 0 END) AS '2015-01',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='2' then i.FAuxWhtPass else 0 END) AS '2015-02',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='3' then i.FAuxWhtPass else 0 END) AS '2015-03',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='4' then i.FAuxWhtPass else 0 END) AS '2015-04',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='5' then i.FAuxWhtPass else 0 END) AS '2015-05',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='6' then i.FAuxWhtPass else 0 END) AS '2015-06',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='7' then i.FAuxWhtPass else 0 END) AS '2015-07',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='8' then i.FAuxWhtPass else 0 END) AS '2015-08',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='9' then i.FAuxWhtPass else 0 END) AS '2015-09',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='10' then i.FAuxWhtPass else 0 END) AS '2015-10',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='11' then i.FAuxWhtPass else 0 END) AS '2015-11',
       sum(case when YEAR(m.FDate)='2015' and MONTH(m.FDate)='12' then i.FAuxWhtPass else 0 END) AS '2015-12',
       sum(case when YEAR(m.FDate)='2016' then i.FAuxWhtPass else 0 END) AS '2016',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='1' then i.FAuxWhtPass else 0 END) AS '2016-01',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='2' then i.FAuxWhtPass else 0 END) AS '2016-02',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='3' then i.FAuxWhtPass else 0 END) AS '2016-03',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='4' then i.FAuxWhtPass else 0 END) AS '2016-04',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='5' then i.FAuxWhtPass else 0 END) AS '2016-05',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='6' then i.FAuxWhtPass else 0 END) AS '2016-06',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='7' then i.FAuxWhtPass else 0 END) AS '2016-07',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='8' then i.FAuxWhtPass else 0 END) AS '2016-08',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='9' then i.FAuxWhtPass else 0 END) AS '2016-09',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='10' then i.FAuxWhtPass else 0 END) AS '2016-10',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='11' then i.FAuxWhtPass else 0 END) AS '2016-11',
       sum(case when YEAR(m.FDate)='2016' and MONTH(m.FDate)='12' then i.FAuxWhtPass else 0 END) AS '2016-12',
       sum(case when YEAR(m.FDate)='2017' then i.FAuxWhtPass else 0 END) AS '2017',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='1' then i.FAuxWhtPass else 0 END) AS '2017-01',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='2' then i.FAuxWhtPass else 0 END) AS '2017-02',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='3' then i.FAuxWhtPass else 0 END) AS '2017-03',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='4' then i.FAuxWhtPass else 0 END) AS '2017-04',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='5' then i.FAuxWhtPass else 0 END) AS '2017-05',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='6' then i.FAuxWhtPass else 0 END) AS '2017-06',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='7' then i.FAuxWhtPass else 0 END) AS '2017-07',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='8' then i.FAuxWhtPass else 0 END) AS '2017-08',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='9' then i.FAuxWhtPass else 0 END) AS '2017-09',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='10' then i.FAuxWhtPass else 0 END) AS '2017-10',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='11' then i.FAuxWhtPass else 0 END) AS '2017-11',
       sum(case when YEAR(m.FDate)='2017' and MONTH(m.FDate)='12' then i.FAuxWhtPass else 0 END) AS '2017-12',
       sum(case when YEAR(m.FDate)='2018' then i.FAuxWhtPass else 0 END) AS '2018',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='1' then i.FAuxWhtPass else 0 END) AS '2018-01',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='2' then i.FAuxWhtPass else 0 END) AS '2018-02',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='3' then i.FAuxWhtPass else 0 END) AS '2018-03',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='4' then i.FAuxWhtPass else 0 END) AS '2018-04',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='5' then i.FAuxWhtPass else 0 END) AS '2018-05',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='6' then i.FAuxWhtPass else 0 END) AS '2018-06',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='7' then i.FAuxWhtPass else 0 END) AS '2018-07',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='8' then i.FAuxWhtPass else 0 END) AS '2018-08',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='9' then i.FAuxWhtPass else 0 END) AS '2018-09',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='10' then i.FAuxWhtPass else 0 END) AS '2018-10',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='11' then i.FAuxWhtPass else 0 END) AS '2018-11',
       sum(case when YEAR(m.FDate)='2018' and MONTH(m.FDate)='12' then i.FAuxWhtPass else 0 END) AS '2018-12',
       sum(case when YEAR(m.FDate)='2019' then i.FAuxWhtPass else 0 END) AS '2019',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='1' then i.FAuxWhtPass else 0 END) AS '2019-01',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='2' then i.FAuxWhtPass else 0 END) AS '2019-02',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='3' then i.FAuxWhtPass else 0 END) AS '2019-03',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='4' then i.FAuxWhtPass else 0 END) AS '2019-04',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='5' then i.FAuxWhtPass else 0 END) AS '2019-05',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='6' then i.FAuxWhtPass else 0 END) AS '2019-06',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='7' then i.FAuxWhtPass else 0 END) AS '2019-07',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='8' then i.FAuxWhtPass else 0 END) AS '2019-08',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='9' then i.FAuxWhtPass else 0 END) AS '2019-09',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='10' then i.FAuxWhtPass else 0 END) AS '2019-10',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='11' then i.FAuxWhtPass else 0 END) AS '2019-11',
       sum(case when YEAR(m.FDate)='2019' and MONTH(m.FDate)='12' then i.FAuxWhtPass else 0 END) AS '2019-12',
       sum(case when YEAR(m.FDate)='2020' then i.FAuxWhtPass else 0 END) AS '2020',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='1' then i.FAuxWhtPass else 0 END) AS '2020-01',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='2' then i.FAuxWhtPass else 0 END) AS '2020-02',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='3' then i.FAuxWhtPass else 0 END) AS '2020-03',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='4' then i.FAuxWhtPass else 0 END) AS '2020-04',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='5' then i.FAuxWhtPass else 0 END) AS '2020-05',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='6' then i.FAuxWhtPass else 0 END) AS '2020-06',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='7' then i.FAuxWhtPass else 0 END) AS '2020-07',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='8' then i.FAuxWhtPass else 0 END) AS '2020-08',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='9' then i.FAuxWhtPass else 0 END) AS '2020-09',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='10' then i.FAuxWhtPass else 0 END) AS '2020-10',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='11' then i.FAuxWhtPass else 0 END) AS '2020-11',
       sum(case when YEAR(m.FDate)='2020' and MONTH(m.FDate)='12' then i.FAuxWhtPass else 0 END) AS '2020-12',
       sum(case when YEAR(m.FDate)='2021' then i.FAuxWhtPass else 0 END) AS '2021',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='1' then i.FAuxWhtPass else 0 END) AS '2021-01',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='2' then i.FAuxWhtPass else 0 END) AS '2021-02',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='3' then i.FAuxWhtPass else 0 END) AS '2021-03',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='4' then i.FAuxWhtPass else 0 END) AS '2021-04',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='5' then i.FAuxWhtPass else 0 END) AS '2021-05',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='6' then i.FAuxWhtPass else 0 END) AS '2021-06',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='7' then i.FAuxWhtPass else 0 END) AS '2021-07',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='8' then i.FAuxWhtPass else 0 END) AS '2021-08',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='9' then i.FAuxWhtPass else 0 END) AS '2021-09',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='10' then i.FAuxWhtPass else 0 END) AS '2021-10',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='11' then i.FAuxWhtPass else 0 END) AS '2021-11',
       sum(case when YEAR(m.FDate)='2021' and MONTH(m.FDate)='12' then i.FAuxWhtPass else 0 END) AS '2021-12',
       sum(case when YEAR(m.FDate)='2022' then i.FAuxWhtPass else 0 END) AS '2022',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='1' then i.FAuxWhtPass else 0 END) AS '2022-01',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='2' then i.FAuxWhtPass else 0 END) AS '2022-02',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='3' then i.FAuxWhtPass else 0 END) AS '2022-03',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='4' then i.FAuxWhtPass else 0 END) AS '2022-04',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='5' then i.FAuxWhtPass else 0 END) AS '2022-05',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='6' then i.FAuxWhtPass else 0 END) AS '2022-06',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='7' then i.FAuxWhtPass else 0 END) AS '2022-07',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='8' then i.FAuxWhtPass else 0 END) AS '2022-08',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='9' then i.FAuxWhtPass else 0 END) AS '2022-09',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='10' then i.FAuxWhtPass else 0 END) AS '2022-10',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='11' then i.FAuxWhtPass else 0 END) AS '2022-11',
       sum(case when YEAR(m.FDate)='2022' and MONTH(m.FDate)='12' then i.FAuxWhtPass else 0 END) AS '2022-12',
       sum(case when YEAR(m.FDate)='2023' then i.FAuxWhtPass else 0 END) AS '2023',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='1' then i.FAuxWhtPass else 0 END) AS '2023-01',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='2' then i.FAuxWhtPass else 0 END) AS '2023-02',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='3' then i.FAuxWhtPass else 0 END) AS '2023-03',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='4' then i.FAuxWhtPass else 0 END) AS '2023-04',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='5' then i.FAuxWhtPass else 0 END) AS '2023-05',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='6' then i.FAuxWhtPass else 0 END) AS '2023-06',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='7' then i.FAuxWhtPass else 0 END) AS '2023-07',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='8' then i.FAuxWhtPass else 0 END) AS '2023-08',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='9' then i.FAuxWhtPass else 0 END) AS '2023-09',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='10' then i.FAuxWhtPass else 0 END) AS '2023-10',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='11' then i.FAuxWhtPass else 0 END) AS '2023-11',
       sum(case when YEAR(m.FDate)='2023' and MONTH(m.FDate)='12' then i.FAuxWhtPass else 0 END) AS '2023-12'
       --SUM(i.FAuxWhtPass) AS FAuxWhtPass
FROM t_ICItem j
LEFT join SHProcRpt i ON j.FItemID = i.FItemID
LEFT JOIN t_SubMessage l ON i.FOperID = l.FInterID
LEFT JOIN SHProcRptMain m ON i.FInterID = m.FInterID
WHERE l.FName = '成型'
and j.FHelpCode like 'GQ%'
GROUP BY j.FHelpCode WITH ROLLUP