create TABLE t_xy_Temp20231229
(
    FModel VARCHAR(255),
    FHelpCode VARCHAR(255),
    FCustName VARCHAR(255)
)

insert into t_xy_Temp20231229 VALUES('FPDCH16.7-14.7-58（1.8）','AF80','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPDCH18.4-16-4(1.5)','AF80','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPDCH20-10-52.2（1.8）','AF80','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPDCH25-9-26.5A','F03','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPDCH25-9-26.5B','AF80','广州市银宝山新汽车零部件有限公司')
insert into t_xy_Temp20231229 VALUES('FPDCH32.5-32-3(1.5)','F03','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPDCH33.5-17-10(1.5)','AF80','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPDCH37.1-27.6-27.5(1.5)/F03','F03','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPDCH41-11.5-25.5(1.5)','AF80','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPDCH41-22.7-31.2A(1.5)','AF80','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPDCH41-22.7-31.2B(1.5)','AF80','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPDCH43.8-17-5(1.5)','AF80','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPDCH49.9-7-20.5A(1.5)','AF80','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPDCH49.9-7-20.5B(1.5)','AF80','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPDCH55-13.4-22.7(1.5)','AF80','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPDCH66.4-6.7-35.8(1.5)','AF80','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPDCH72.4-8-35.5(1.5)','AF80','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPEC4.3-5(0.8)','F03','广州市银宝山新汽车零部件有限公司')
insert into t_xy_Temp20231229 VALUES('FPEC5.8-11.5(1.0)V','F03','广州市银宝山新汽车零部件有限公司')
insert into t_xy_Temp20231229 VALUES('FPEC5.8-11.5(1.0)V','F03','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPEC9.5-17(1.0)','F03','广州市银宝山新汽车零部件有限公司')
insert into t_xy_Temp20231229 VALUES('FPEC9.5-17(1.0)','F03','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPECB22.4-1.9-31.5(1.1)C','AF80','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPECB37-14-24(1.2)','BY1','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPECY11.1-7.5-11.2(1.5)','F03','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPECY11.2-4.8-12.3(1.5)','F03','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPECY12.8-12-7.5(1.5)','F03','广州市银宝山新汽车零部件有限公司')
insert into t_xy_Temp20231229 VALUES('FPECY12.8-12-7.5(1.5)','F03','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPECY12-5.9-16.5(1.5)','AF80','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPECY12-5.9-16.5(1.5)','F03','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPECY16.4-6.2-10(1.5)Q','F03','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPECY16.4-6.7-10(1.5)Q','F03','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPECY17.2-6-7.8(1.5)','AF80','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPECY17-15-10.5（1.5）','F03','广州市银宝山新汽车零部件有限公司')
insert into t_xy_Temp20231229 VALUES('FPECY37-16.7-27.8(1.2)','F03','广州市银宝山新汽车零部件有限公司')
insert into t_xy_Temp20231229 VALUES('FPECY6.5-6.0-6.8(1.5)','F03','广州市银宝山新汽车零部件有限公司')
insert into t_xy_Temp20231229 VALUES('FPECY6.8-6.3-4.8(1.5)','F03','广州市银宝山新汽车零部件有限公司')
insert into t_xy_Temp20231229 VALUES('FPECY6.8-6.3-4.8(1.5)','F03','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPECY7.8-7.2-5.5(1.5)','F03','广州市银宝山新汽车零部件有限公司')
insert into t_xy_Temp20231229 VALUES('FPECY7.8-7.2-5.5(1.5)','F03','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPECY9.8-9.1-5.5(1.5)','F03','广州市银宝山新汽车零部件有限公司')
insert into t_xy_Temp20231229 VALUES('FPECY9.8-9.1-5.5(1.5)','F03','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPECY9.8-9.1-8(1.5)','F03','广州市银宝山新汽车零部件有限公司')
insert into t_xy_Temp20231229 VALUES('FPECYB24.5-4-36.8(1.4)','F03','广州市银宝山新汽车零部件有限公司')
insert into t_xy_Temp20231229 VALUES('FPECYB24.5-4-36.8(1.4)','F03','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPECYB25-4-36.8(1.4)','AF80','广州市银宝山新汽车零部件有限公司')
insert into t_xy_Temp20231229 VALUES('FPECYB25-4-36.8(1.4)','AF80','宁波新华泰模塑电器有限公司')
insert into t_xy_Temp20231229 VALUES('FPYTF37-16-12-36.5-34(1.5)/F03','F03','宁波新华泰模塑电器有限公司')

;WITH cte
AS
(
SELECT  
    t1.FModel,
    t1.FHelpCode,
    t2.fname as fcustname,
    sum(case when YEAR(v1.FDate)='2013' then u1.FConsignAmount else 0 END) AS '2013',
    sum(case when YEAR(v1.FDate)='2014' then u1.FConsignAmount else 0 END) AS '2014',
    sum(case when YEAR(v1.FDate)='2015' then u1.FConsignAmount else 0 END) AS '2015',
    sum(case when YEAR(v1.FDate)='2016' then u1.FConsignAmount else 0 END) AS '2016',
    sum(case when YEAR(v1.FDate)='2017' then u1.FConsignAmount else 0 END) AS '2017',
    sum(case when YEAR(v1.FDate)='2018' then u1.FConsignAmount else 0 END) AS '2018',
    sum(case when YEAR(v1.FDate)='2019' then u1.FConsignAmount else 0 END) AS '2019',
    sum(case when YEAR(v1.FDate)='2020' then u1.FConsignAmount else 0 END) AS '2020',
    sum(case when YEAR(v1.FDate)='2021' then u1.FConsignAmount else 0 END) AS '2021',
    sum(case when YEAR(v1.FDate)='2022' then u1.FConsignAmount else 0 END) AS '2022',
    sum(case when YEAR(v1.FDate)='2023' then u1.FConsignAmount else 0 END) AS '2023'
FROM t_ICItem t1 
LEFT JOIN ICStockBillEntry u1 ON t1.FItemID=u1.FItemID
INNER JOIN ICStockBill v1 ON u1.FInterID=v1.FInterID
LEFT join t_Organization t2 ON v1.FSupplyID=t2.FItemID
WHERE 
--YEAR(t2.FCreateDate) in ('2023') AND MONTH(t2.FCreateDate)='10'
--where year(v1.FDate)IN ('2022') 
--and year(t2.FCreateDate) in ('2022')
--and month(v1.FDate)<='6'
--t1.FHelpCode like 'GQ%'
v1.FTranType=21 And v1.FCheckerID>0
GROUP BY t1.FModel,t1.FHelpCode,t2.FName
)
select * 
FROM t_xy_Temp20231229 t1
LEFT JOIN cte t2 on t1.FModel=t2.fmodel AND t1.FHelpCode=t2.fhelpcode and t1.FCustName=t2.fcustname

SELECT * FROM t_ICItem WHERE FModel='FPDCH16.7-14.7-58（1.8）'

drop TABLE t_xy_Temp20231229